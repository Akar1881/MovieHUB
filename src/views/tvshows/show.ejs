<%- include('../partials/header') %>

<div class="container">
    <div class="tvshow-details">
        <div class="tvshow-poster">
            <img src="<%= tvshow.poster %>" alt="<%= tvshow.title %>">
        </div>
        <div class="tvshow-info">
            <h1><%= tvshow.title %></h1>
            <p class="tvshow-description"><%= tvshow.description %></p>
            <p class="tvshow-seasons">Seasons: <%= tvshow.seasons %></p>
            
            <div class="tvshow-episodes">
                <h3>Episodes</h3>
                <% episodes.forEach(episode => { %>
                    <div class="episode">
                        <h4>Season <%= episode.season %> Episode <%= episode.episode %></h4>
                        <a href="/tvshows/<%= tvshow.id %>/episode/<%= episode.id %>" class="btn">Watch</a>
                    </div>
                <% }); %>
            </div>

            <div class="tvshow-reviews">
                <h3>Reviews</h3>
                <% if (user) { %>
                    <form action="/tvshows/<%= tvshow.id %>/review" method="POST" class="review-form">
                        <div class="form-group">
                            <label for="rating">Rating</label>
                            <select name="rating" id="rating" required>
                                <option value="5">5 Stars</option>
                                <option value="4">4 Stars</option>
                                <option value="3">3 Stars</option>
                                <option value="2">2 Stars</option>
                                <option value="1">1 Star</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="comment">Comment</label>
                            <textarea name="comment" id="comment" required></textarea>
                        </div>
                        <button type="submit" class="btn">Submit Review</button>
                    </form>
                <% } %>

                <div class="reviews-list">
                    <% reviews.forEach(review => { %>
                        <div class="review">
                            <div class="review-header">
                                <span class="review-author"><%= review.username %></span>
                                <span class="review-rating"><%= review.rating %> stars</span>
                            </div>
                            <p class="review-comment"><%= review.comment %></p>
                            <small class="review-date">
                                <%= new Date(review.created_at).toLocaleDateString() %>
                            </small>
                        </div>
                    <% }); %>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>